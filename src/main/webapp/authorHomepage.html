
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>用户个人主页</title>
    <!--[if lt IE 9]>
    <![endif]-->
    <!--这三句话保证了样式的完整性-->
    <script src="//s3.pstatp.com/toutiao/resource/ntoutiao_web/static/js/common/lib_d2cb17c.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="//s3b.pstatp.com/toutiao/resource/ntoutiao_web/page/profile/profile_ca978ee.css" />
    <script src="//s3.pstatp.com/toutiao/resource/ntoutiao_web/page/profile/index_9cb669f.js"></script>

    <link href="css/bootstrap.css" rel='stylesheet' type='text/css' />
    <!-- Custom Theme files -->
    <link href='css/font.css' rel='stylesheet' type='text/css'>
    <link href="css/style.css" rel='stylesheet' type='text/css' />
    <script src="js/jquery/jquery-2.1.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!-- animation-effect -->
    <link href="css/animate.min.css" rel="stylesheet">
    <script src="js/wow.min.js"></script>
</head>
<body style="min-width: 768px; overflow-x: hidden;">
<div class="y-wrap">
    <!-- 公共头部 -->
    <div id="header">
    </div>
    <!--最重要的主题部分-->
    <div id="wrapper">
        <div class="left">
            <!--这是左边版面的文章和视频-->
            <div riot-tag="tab">

            </div>
            <!--左边版面用来-->
            <div riot-tag="feedBox"></div>
        </div>
        <div class="right">
            <!--右边的数据关注量-->
            <div riot-tag="statistics"></div>
            <!--右边的作者阅读量最高的新闻排行-->
            <div riot-tag="recent"></div>
        </div>
    </div>
    <!--公共底部-->
    <div class="footer-push"></div>
    <div riot-tag="ugcBox"></div>
</div>

<script>
    riot.observable(window);
</script>

<!-- 公共尾部 -->
<div id="footer">
</div>
<script type="text/javascript">
    var userInfo = {
    };
    var userData={
    };
    var media = {
    };
    var header={
    };

    var tab={
        tabs:[{
            text:'新闻',
            code:'b'
        }],
        active:'a',
        idx: 0,
        click:function(e){
            if(e.target&&e.target.getAttribute('code')){
                this.opts.active=e.target.getAttribute('code');
                this.opts.idx=e.target.getAttribute('idx');
                window.trigger('tabChange',this.opts.active)
            }
        }
    };
</script>
<script>

    /*用户个人主页的右边部分*/
    riot.mount('login');
    riot.mount('wsearch');
    riot.mount('yheader',header);
    riot.mount('statistics',{
        guanzhu:'28',
        fensi:'69558066',
        base_url:'/c/user/relation/4492956276/'
    });
    riot.mount('recent',{
        mediaId: userInfo.mediaId,
        isBanned: userInfo.isBanned
    });
    riot.mount('top');

    function initTab() {
        var defaultTabCode = '';
        var codeMap = {
            article: 'a',
            video: 'b',
            favourite: 'c',
            weitoutiao: 'd'
        };
        var hash=location.search.slice(1).match(/[^&]+/g)||[];

        if (hash) {
            _.each(hash, function(item) {
                item = item.split('=');
                if (item && item.length == 2 && item[0] == 'tab') {
                    _.find(['article','video','favourite','weitoutiao'], function(v) {
                        if (v == item[1]) {
                            defaultTabCode = codeMap[v];
                        }
                    });
                }
            });
        }
        // url 中 tab 指定的不存在时，回退为第一个
        var codes = _.pluck(tab.tabs, 'code');
        (_.indexOf(codes, defaultTabCode) === -1) && (defaultTabCode = tab.tabs[0].code);

        // 更新 tab.idx
        _.each(tab.tabs, function(item, idx) {
            (item.code == defaultTabCode) && (tab.idx = idx);
        })

        riot.mount('tab', tab);
        riot.mount('feedBox',{
            siblingList: [],
            code: defaultTabCode,
            isBanned: userInfo.isBanned
        });
    }

    var ugcApiParams = {
        category: 'pc_profile_ugc',
        utm_source: 'toutiao',
        visit_user_id: userInfo.id,
        max_behot_time: 0,
        t: +new Date()
    };

    http({
     /*   url: '/toutiao/api/pc/feed/',*/
        method: 'get',
        type: 'json',
        data: ugcApiParams,
        success: function(rs) {
            var l = 0;

            if (rs && rs.message === 'success' && rs.data) {
                l = rs.data.length;
            }

            if (l > 0) {
                var firstTab = tab.tabs[0].code;

                if (firstTab === 'a') {
                    tab.tabs.splice(2, 0, {
                        text: '微头条',
                        code: 'd'
                    });
                } else {
                    tab.tabs.splice(1, 0, {
                        text: '微头条',
                        code: 'd'
                    });
                }
            }

            initTab();
        },
        error: function () {
            initTab();
        }
    });
</script>
<script src="//s95.cnzz.com/z_stat.php?id=1259612802&web_id=1259612802" language="JavaScript"></script>
<script src="js/jquery/jquery-2.1.1.min.js"></script>
<script type="text/javascript">
    $(function () {
        $("#header").load("header.html");
        $("#footer").load("footer.html");
    })
</script>
</body>
</html>